┌─────────────────────────────────────────────────────────────────────────────┐
│                         COST FLOW & CHARGEBACK MODEL                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌──────────────┐                                                          │
│  │GCP Billing   │                                                          │
│  │Export        │─────────────────────────────────────┐                    │
│  │(Raw Data)    │                                     │                    │
│  └──────────────┘                                     │                    │
│           │                                           │                    │
│           ▼                                           │                    │
│  ┌───────────────────────────────────────────────┐   │                    │
│  │          COST ATTRIBUTION ENGINE              │   │                    │
│  ├───────────────────────────────────────────────┤   │                    │
│  │  • Label Enrichment (Project, Environment)    │   │                    │
│  │  • Resource Tagging (Automated via Terraform) │   │                    │
│  │  • Usage Metrics (Compute/Storage/Network)    │   │                    │
│  └───────────────────────────────────────────────┘   │                    │
│           │                                           │                    │
│           ▼                                           ▼                    │
│  ┌────────────────────────────────┐    ┌───────────────────────────────┐   │
│  │       ALLOCATION LOGIC         │    │    SHARED COSTS & DISCOUNTS   │   │
│  ├────────────────────────────────┤    ├───────────────────────────────┤   │
│  │ Direct Costs:                  │    │ • Networking                  │   │
│  │ • 1:1 attribution to projects │    │ • Support                     │   │
│  │ • VM, GKE, BigQuery, etc.     │    │ • Management tools            │   │
│  │                                │    │ • CUD/SUD allocation          │   │
│  │                                │    │ • Spot savings distribution   │   │
│  └────────────────────────────────┘    └───────────────────────────────┘   │
│                    │                                  │                    │
│                    └───────────────┬──────────────────┘                    │
│                                    ▼                                       │
│  ┌────────────────────────────────────────────────────────────────────┐    │
│  │                         SHOWBACK REPORTS                           │    │
│  ├────────────────────────────────────────────────────────────────────┤    │
│  │                                                                    │    │
│  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐    │    │
│  │  │ Department-Level│  │ Team/Project    │  │ Unit Economics  │    │    │
│  │  │ Dashboard       │  │ Breakdown       │  │ Cost per:       │    │    │
│  │  │ • Monthly spend │  │ • Engineering   │  │ • User         │    │    │
│  │  │ • Trend analysis│  │ • Marketing     │  │ • Transaction  │    │    │
│  │  │ • Budget vs.    │  │ • Finance       │  │ • API call     │    │    │
│  │  │   actual        │  │ • Operations    │  │                │    │    │
│  │  └─────────────────┘  └─────────────────┘  └─────────────────┘    │    │
│  └────────────────────────────────────────────────────────────────────┘    │
│                                    │                                       │
│                                    ▼                                       │
│  ┌────────────────────────────────────────────────────────────────────┐    │
│  │                    CHARGEBACK (OPTIONAL)                           │    │
│  ├────────────────────────────────────────────────────────────────────┤    │
│  │                                                                    │    │
│  │  ┌─────────────────────────┐    ┌─────────────────────────┐       │    │
│  │  │ Internal Billing        │    │ Budget Alerts           │       │    │
│  │  │ Department P&L impact   │    │ 80% / 100% thresholds   │       │    │
│  │  │ Cross-charging enabled  │    │ Anomaly detection       │       │    │
│  │  └─────────────────────────┘    └─────────────────────────┘       │    │
│  └────────────────────────────────────────────────────────────────────┘    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
